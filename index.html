<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/icons8-autumn-material-filled-32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/icons8-autumn-material-filled-16.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="今朝梦醒与君别，遥盼春风寄相思">
<meta property="og:type" content="website">
<meta property="og:title" content="Q1ngying">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="Q1ngying">
<meta property="og:description" content="今朝梦醒与君别，遥盼春风寄相思">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Q1ngying">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>Q1ngying</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Q1ngying</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">清影的个人站</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/03/05/Huff-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Q1ngying">
      <meta itemprop="description" content="今朝梦醒与君别，遥盼春风寄相思">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Q1ngying">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/03/05/Huff-1/" class="post-title-link" itemprop="url">Huff(1)</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2024-03-05 20:35:53 / 修改时间：20:43:13" itemprop="dateCreated datePublished" datetime="2024-03-05T20:35:53+08:00">2024-03-05</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/learn/" itemprop="url" rel="index"><span itemprop="name">learn</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Solidity/" itemprop="url" rel="index"><span itemprop="name">Solidity</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/EVM/" itemprop="url" rel="index"><span itemprop="name">EVM</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Opcode/" itemprop="url" rel="index"><span itemprop="name">Opcode</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Huff/" itemprop="url" rel="index"><span itemprop="name">Huff</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>2.4k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>8 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Huff"><a href="#Huff" class="headerlink" title="Huff"></a>Huff</h2><h3 id="Huff-安装"><a href="#Huff-安装" class="headerlink" title="Huff 安装"></a>Huff 安装</h3><p>官网：<a target="_blank" rel="noopener" href="https://docs.huff.sh/">https://docs.huff.sh</a> </p>
<p>Windows系统下，能够成功按照 rust 和 Foundry 的话，直接通过 cargo 命令一次就能成功的安装 Huff。如果没有成功安装 Rust 和 Foundry，大致解决方法：</p>
<ul>
<li>安装 gcc （我没安装 Visul Studio tool C++ 生成工具，那玩意太大了也不好按，网上有关于  Visul Studio tool C++ 生成工具的轻量级 C++ 生成工具的替代</li>
<li>为 git 配置了代理，因为我感觉 cargo 有时候还是用的 git ，我是之前装 Foundry 卡了好几次，之前为了传博客给 git 挂了代理之后方便，安装 Huff 的时候一次成功</li>
<li>rust 安装直接在 c++ 生成工具安装完毕后吗，直接通过 rustup 安装即可。</li>
<li>foundry 安装通过 cargo 下载即可，Foundry 官方文档中有该命令</li>
</ul>
<h3 id="Huff-入门"><a href="#Huff-入门" class="headerlink" title="Huff 入门"></a>Huff 入门</h3><h4 id="基本构成："><a href="#基本构成：" class="headerlink" title="基本构成："></a>基本构成：</h4><p>Huff 需要主函数（main）函数，需要宏，注意，定义宏时，宏函数名需要全大写，然后加上<code>=</code>，<code>takes</code>，<code>returns</code>，takes 表示从堆栈上取的字节，returns 表示返回到堆栈上的字节。</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#define <span class="keyword">macro</span> <span class="title function_ invoke__">MAIN</span>() = <span class="title function_ invoke__">takes</span>(<span class="number">0</span>) <span class="title function_ invoke__">returns</span>(<span class="number">0</span>) &#123;&#125;</span><br></pre></td></tr></table></figure>

<h4 id="编译-huff："><a href="#编译-huff：" class="headerlink" title="编译 huff："></a>编译 huff：</h4><h5 id="huffc-path-b"><a href="#huffc-path-b" class="headerlink" title="huffc path (-b)"></a>huffc path (-b)</h5><p>使用命令：<code>huffc &quot;路径.huff&quot;</code></p>
<p>如果要获取对应的 solidity bytecode 可以加上 <code>-b</code> 选项</p>
<p>上面的例子：</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#define <span class="keyword">macro</span> <span class="title function_ invoke__">MAIN</span>() = <span class="title function_ invoke__">takes</span>(<span class="number">0</span>) <span class="title function_ invoke__">returns</span>(<span class="number">0</span>) &#123;&#125;</span><br></pre></td></tr></table></figure>

<p>中，虽然我们没有<code>runtimec code</code>，也没有编写任何代码，<strong>但是我们通过运行命令得到了相对应的 solidity bytecode</strong> ：<code>60008060093d393df3</code>。得到的这一部分其实就是上面提到的 <code>contract creation code </code> 这是 <code>huff</code> 编译器知道我们<strong>至少需要代码创建合约</strong>尽管我们编译这个huff合约不做任何事情。</p>
<p>对于刚刚的<code>60008060093d393df3</code>，我们可以对其进行分析：</p>
<p>比如 opcoded 39 是<code>codecopy</code>，上面的<code>F3 3D 39</code>确实看到了一个代码复制操作</p>
<h5 id="huffc-path-–bin-runtime"><a href="#huffc-path-–bin-runtime" class="headerlink" title="huffc path –bin-runtime"></a>huffc path –bin-runtime</h5><p>该命令是获取现在的 huff 代码在区块链上的 <code>runtime code</code>：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">huffc path --bin-runtime</span><br></pre></td></tr></table></figure>

<p>比如下面的代码：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 60008060093d393df3</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> macro MAIN() = takes(0) returns(0) &#123;</span></span><br><span class="line">    <span class="comment">// 0x00             // [0]</span></span><br><span class="line">    <span class="comment">// // 0x02           // TOP [2, 0] BOTTOM</span></span><br><span class="line">    <span class="comment">// calldataload    // [calldata (32)] </span></span><br><span class="line">    <span class="comment">// // how do we cut down the calldata -&gt; func selector?</span></span><br><span class="line">    <span class="comment">// // right shift 28 bytes, 224 bits | 224 -&gt; 0xe0</span></span><br><span class="line">    <span class="comment">// 0xe0            // TOP [0xe0, calldata (32)] BOTTOM</span></span><br><span class="line">    <span class="comment">// shr             // [func selector]</span></span><br><span class="line">    <span class="number">0x00</span> calldataload <span class="number">0xe0</span> shr <span class="comment">// [function_selector]</span></span><br><span class="line">        </span><br><span class="line">    <span class="comment">// jump =&gt; function data associated with the selector</span></span><br><span class="line">    <span class="comment">// If f_select == updateHorseNumber -&gt; jump to that code</span></span><br><span class="line">    <span class="comment">// If f_select == readHorseNumber -&gt; jump to that code</span></span><br><span class="line">    <span class="comment">// 0xcdfead2e == update </span></span><br><span class="line">    <span class="comment">// 0xe026c017 == read </span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// updateHorseNumber selector</span></span><br><span class="line">    <span class="number">0xcdfead2e</span>          <span class="comment">// [0xcdfead2e. function_selector]</span></span><br><span class="line">    eq                  <span class="comment">// [true_if_func_selector_matches]</span></span><br><span class="line">    <span class="comment">// jump to updateHorseNumber code if true</span></span><br><span class="line">    updateJump          <span class="comment">// [updateHorseNumberProgramCounter, true/false]</span></span><br><span class="line">    jumpi</span><br><span class="line">    updateJump:</span><br><span class="line">        SET_NUMBER_OF_HORSE()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> macro SET_NUMBER_OF_HORSE() = takes(0) returns(0) &#123;&#125;</span></span><br></pre></td></tr></table></figure>

<p>运行<code>huffc path --bin-runtime</code>的结果为：<code>5f3560e01c63cdfead2e1461000f575b</code></p>
<h4 id="Huff-FUNC-SIG-Interface"><a href="#Huff-FUNC-SIG-Interface" class="headerlink" title="Huff __FUNC_SIG &amp; Interface"></a>Huff __FUNC_SIG &amp; Interface</h4><p>在 Huff 中，我们无需通过 <code>cast sig</code> 命令获取函数选择器（function selector），Huff 提供了一个语法可以使得我们无需计算函数选择器：<code>__FUNC_SIG()</code></p>
<p>同时，可以像在 Solidity 中一样定义一个接口 （Interface）</p>
<p>代码如下：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Interface */</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> function updateHorseNumber(uint256) nonpayable returns()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> function readNumberOfHorses() view returns(uint256)</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> marco MAIN() = takes(0) returns(0) &#123;</span></span><br><span class="line">	...</span><br><span class="line">    __FUNC_SIG(readNumberOfHorses) <span class="comment">// 等价于手动通过命令 cast sig 计算得到的函数 `updateHorseNumber(uint256)` 的选择器</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>这个语法糖可以很好的帮助我们计算函数选择器</p>
<h4 id="Huff-opcode"><a href="#Huff-opcode" class="headerlink" title="Huff opcode"></a>Huff opcode</h4><h5 id="push"><a href="#push" class="headerlink" title="push"></a><em>push</em></h5><p>在 Huff 中执行 <code>push</code> opcode 时，直接把需要 push 到堆栈中的数据写下来即可，因为 huff 编译器能够根据数据的大小，智能的选择对应的 push 系操作码</p>
<p><strong>所以，在 Huff 中执行 push opcode，只需要输入实际的值即可</strong></p>
<p>当有人向智能合约发送任何调用数据时，智能合约现在唯一要做的就是将 0 push 到堆栈上去。</p>
<p>举例：</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">#define <span class="keyword">macro</span> <span class="title function_ invoke__">MAIN</span>() = <span class="title function_ invoke__">takes</span>(<span class="number">0</span>) <span class="title function_ invoke__">returns</span>(<span class="number">0</span>) &#123;</span><br><span class="line">    <span class="number">0x00</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>将下面的代码用 huffc 编译结果：<code>60018060093d393df35f</code>，得到的结果是比刚刚合约创建时的代码更长一些。在<code>f3</code>后，多了一个<code>5f</code> opcode 这个字节码就是 <code>PUSH0</code></p>
<h5 id="calldataload"><a href="#calldataload" class="headerlink" title="calldataload"></a><em>calldataload</em></h5><p>**接收一个堆栈输入(Stack input)，并给出一个堆栈输出(Stack output)**，所以堆栈输入的数据加载是我们首先将零推到堆栈上（<code>PUSH0 5f</code>）的原因.</p>
<p>查看调用数据，抓取栈顶的值，作为偏移量（offset）</p>
<p><strong>Stack input 堆栈输入</strong></p>
<p><code>i</code>: byte offset in the <a target="_blank" rel="noopener" href="https://www.evm.codes/about">calldata</a></p>
<p>calldata 中的字节偏移量。</p>
<p><strong>Stack output 堆栈输出</strong></p>
<p><code>data[i]</code>: 32-byte value starting from the given offset of the <a target="_blank" rel="noopener" href="https://www.evm.codes/about">calldata</a>. All bytes after the end of the <a target="_blank" rel="noopener" href="https://www.evm.codes/about">calldata</a> are set to 0.data[i]</p>
<p>从给定的 calldata 偏移量开始的 32 字节值。calldata 结束之后的所有字节都设置为 0。</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#define <span class="keyword">macro</span> <span class="title function_ invoke__">MAIN</span>() = <span class="title function_ invoke__">takes</span>(<span class="number">0</span>) <span class="title function_ invoke__">returns</span>(<span class="number">0</span>) &#123;</span><br><span class="line">    <span class="number">0x00</span>          <span class="comment">// [0]</span></span><br><span class="line">    <span class="comment">// 0x02         // TOP [2, 0] BOTTOM</span></span><br><span class="line">    calldataload  <span class="comment">// [calldata] (The first 32 bytes of calldata)</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/../images/Huff-1/image-20240304190428283.png" alt="image-20240304190428283"></p>
<p>最开始的calldata为：<code>0xcdfead2e0000000000000000000000000000000000000000000000000000000000000001</code></p>
<p>因为 calldataload 只能获取32 个字节，所以此时堆栈中的 calldata 其实是：<code>0xcdfead2e00000000000000000000000000000000000000000000000000000000</code>（但其实不是我们想要的）</p>
<h5 id="shr-Right-Shift-右移位"><a href="#shr-Right-Shift-右移位" class="headerlink" title="shr(Right Shift) 右移位"></a><em>shr(Right Shift) 右移位</em></h5><p>Shift the bits towards the least significant one. The bits moved before the first one are discarded, the new bits are set to 0.</p>
<p>将位移向最不重要的位。丢弃第一个位之前移动的位，新位设置为 0。</p>
<p><strong>Stack input 堆栈输入</strong></p>
<ol>
<li><code>shift</code>: number of bits to shift to the right.shift 向右移动的位数。</li>
<li><code>value</code>: 32 bytes to shift. 要移位的 32 个字节。</li>
</ol>
<p><strong>Stack output 堆栈输出</strong></p>
<p><code>value &gt;&gt; shift</code>: the shifted value. If <code>shift</code> is bigger than 255, returns 0.value &gt;&gt; shift </p>
<p>移位值。如果 shift 大于 255，则返回 0。</p>
<p>举例：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// SHR opcode</span></span><br><span class="line"><span class="comment">// 0x0102 (bytes)</span></span><br><span class="line"><span class="comment">// 1 bytes = 8 bits </span></span><br><span class="line"><span class="comment">// 0b100000010 &gt;&gt; 2</span></span><br><span class="line"><span class="comment">//  0b1000000</span></span><br></pre></td></tr></table></figure>

<p>可以理解为 value 的二进制数据全部向右移两位（直接去掉后两位）</p>
<p>举例：evm-code playground</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PUSH2 0x0102</span><br><span class="line">PUSH1 0x04</span><br><span class="line">SHR</span><br></pre></td></tr></table></figure>



<p>堆栈如下：</p>
<p><img src="/../images/Huff-1/image-20240304192101966.png" alt="image-20240304192101966"></p>
<p><em><strong>shr on calldata</strong></em></p>
<p>对于calldata：<code>0xcdfead2e0000000000000000000000000000000000000000000000000000000000000001</code> 我们起初想要的其实是<code>0xcdfead2e</code>（函数选择器 selector）</p>
<p>刚刚我们已经使用了<code>calldataload</code>，获得了 calldata(32bytes):<code>0xcdfead2e00000000000000000000000000000000000000000000000000000000</code>。但是接下来我们需要函数选择器，那么，借助 <code>shr</code> 右移位 224 即可（56 &#x2F; 2 &#x3D; 28 bytes 28 * 8 &#x3D; 224 bits | 224 -&gt; 0xe0)</p>
<h5 id="EQ"><a href="#EQ" class="headerlink" title="EQ"></a><em>EQ</em></h5><p>从栈顶弹出两个数据进行比较，相同将 1 压入堆栈，不同将 0 压入堆栈。</p>
<p><strong>Stack input 堆栈输入</strong></p>
<ol>
<li><code>a</code>: left side integer.    左边整数。</li>
<li><code>b</code>: right side integer   右边整数。</li>
</ol>
<p><strong>Stack output 堆栈输出</strong></p>
<p><code>a == b</code>: 1 if the left side is equal to the right side, 0 otherwise.a &#x3D;&#x3D; b  如果左侧等于右侧，则为 1，否则为 0。</p>
<h5 id="JUMP-JUMPI-JUMPDEST"><a href="#JUMP-JUMPI-JUMPDEST" class="headerlink" title="JUMP &amp;  JUMPI &amp; JUMPDEST"></a><em>JUMP &amp;  JUMPI &amp; JUMPDEST</em></h5><p>The program counter (PC) is a byte offset in the deployed <a target="_blank" rel="noopener" href="https://www.evm.codes/about">code</a>. It indicates which instruction will be executed next. When an <a target="_blank" rel="noopener" href="https://www.evm.codes/#01">ADD</a> is executed, for example, the PC is incremented by 1, since the instruction is 1 byte. The <a target="_blank" rel="noopener" href="https://www.evm.codes/#60">PUSH</a> instructions are bigger than one byte, and so will increment the counter accordingly.</p>
<p>程序计数器 （PC） 是已部署代码中的字节偏移量。它指示接下来将执行的指令。例如，当执行 ADD 时，PC 会递增 1，因为指令是 1 字节。PUSH 指令大于一个字节，因此会相应地递增计数器。</p>
<p>The <strong>JUMP</strong> instruction alters the program counter, thus breaking the linear path of the execution to another point in the deployed <a target="_blank" rel="noopener" href="https://www.evm.codes/about">code</a>. It is used to implement functionalities like functions.JUMP</p>
<p>指令更改程序计数器，从而将执行的线性路径中断到已部署代码中的另一个点。它用于实现功能等功能。</p>
<p><strong>JUMP：</strong></p>
<p><strong>Stack input 堆栈输入</strong></p>
<p><code>counter</code>: byte offset in the deployed <a target="_blank" rel="noopener" href="https://www.evm.codes/about">code</a> where execution will continue from. Must be a <a target="_blank" rel="noopener" href="https://www.evm.codes/#5B">JUMPDEST</a> instruction.</p>
<p>已部署代码中的字节偏移量，从中继续执行。必须是 JUMPDEST 指令。</p>
<p><strong>JUMPI：</strong></p>
<p><strong>Stack input 堆栈输入</strong></p>
<p><strong>第一个值是 JUMPDEST 的偏移量，第二个值是 true&#x2F;false</strong></p>
<p><code>counter</code>: byte offset in the deployed <a target="_blank" rel="noopener" href="https://www.evm.codes/about">code</a> where execution will continue from. Must be a <a target="_blank" rel="noopener" href="https://www.evm.codes/#5B">JUMPDEST</a> instruction.</p>
<p>已部署代码中的字节偏移量，从中继续执行。必须是 JUMPDEST 指令。</p>
<p><code>b</code>: the program counter will be altered with the new value only if this value is different from 0. Otherwise, the program counter is simply incremented and the next instruction will be executed.</p>
<p>只有当新值与不为 0 时，程序计数器才会更改为新值。否则，程序计数器将简单地递增，并执行下一条指令。</p>
<p><strong>JUMPDEST</strong></p>
<p>Mark a valid destination for <a target="_blank" rel="noopener" href="https://www.evm.codes/#56">JUMP</a> or <a target="_blank" rel="noopener" href="https://www.evm.codes/#57">JUMPI</a>. This operation has no effect on machine state during execution.</p>
<p>标记 JUMP 或 JUMPI 的有效目的地。此操作在执行期间对计算机状态没有影响。</p>
<p><strong>使用 JUMP 和 JUMPI 需要计算程序计数器（PC）（因为 JUMP 和 JUMPI 的目标都必须是 JUMPDEST），但是 Huff 有相关的语法可以帮助我们</strong>，我们可以在这里写一些文本，将定义某个宏的程序计数器（PC）</p>
<p>比如下面的代码：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">    <span class="number">0xe026c017</span>          <span class="comment">// [0xe026c017, function_selector]</span></span><br><span class="line">    eq                  <span class="comment">// [true_if_func_selector_matches]</span></span><br><span class="line">    readJump            <span class="comment">// [readJump, true_if_func_selector_matches]</span></span><br><span class="line">    jumpi</span><br><span class="line"></span><br><span class="line">    readJump:</span><br><span class="line">        GET_NUMBER_OF_HORSES()</span><br><span class="line">        </span><br><span class="line"><span class="meta">#<span class="keyword">define</span> macro GET_NUMBER_OF_HORSES() = takes(0) returns(0) &#123;&#125;</span></span><br></pre></td></tr></table></figure>

<p>堆栈图：</p>
<p><img src="/../images/Huff-1/image-20240305195047849.png" alt="image-20240305195047849"></p>
<h5 id="DUP"><a href="#DUP" class="headerlink" title="DUP"></a>DUP</h5><p>DUP 是一个大类的 opcode ，其范围为 1 ~ 16（即 DUP1 ~ DUP16，对应 0x80 ~ 0x8f），其功能是复制目前从栈顶开始的第 n 个值，并将复制得到的值压入堆栈</p>
<p>DUP 代码举例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dup1                // [function_selector, function_selector]</span><br><span class="line">0xcdfead2e          // [0xcdfead2e, function_selector, function_selector]</span><br><span class="line">eq                  // [true_if_func_selector_matches, function_selector]</span><br></pre></td></tr></table></figure>

<p>堆栈图：</p>
<p><img src="/../images/Huff-1/image-20240305200602341.png" alt="image-20240305200602341"></p>
<p>接着以 DUP2 为其他的举例：</p>
<p><img src="/../images/Huff-1/image-20240305200645472.png" alt="image-20240305200645472"></p>
<h5 id="REVERT"><a href="#REVERT" class="headerlink" title="REVERT"></a>REVERT</h5><p>Stop the current context execution, revert the state changes (see <a target="_blank" rel="noopener" href="https://www.evm.codes/#FA">STATICCALL</a> for a list of state changing opcodes) and return the unused gas to the caller. It also reverts the gas refund to its value before the current context. If the execution is stopped with REVERT, the value 0 is put on the stack of the calling context, which continues to execute normally. The <a target="_blank" rel="noopener" href="https://www.evm.codes/about">return data</a> of the calling context is set as the given chunk of memory of this context.</p>
<p>停止当前上下文执行，恢复状态更改（有关状态更改操作码的列表，请参阅 STATICCALL），并将未使用的 gas 返回给调用方。它还会将 gas 退款恢复到当前上下文之前的值。如果使用 REVERT 停止执行，则值 0 将放在调用上下文的堆栈上，该堆栈将继续正常执行。调用上下文的返回数据设置为此上下文的给定内存块。</p>
<p><strong>Stack input 堆栈输入</strong></p>
<ol>
<li><code>offset</code>: byte offset in the <a target="_blank" rel="noopener" href="https://www.evm.codes/about">memory</a> in bytes. The return data of the calling context.offset：内存中的字节偏移量（以字节为单位）。调用上下文的返回数据。</li>
<li><code>size</code>: byte size to copy (size of the <a target="_blank" rel="noopener" href="https://www.evm.codes/about">return data</a>).size：要复制的字节大小（返回数据的大小）。</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/01/21/Dex2-wp/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Q1ngying">
      <meta itemprop="description" content="今朝梦醒与君别，遥盼春风寄相思">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Q1ngying">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/01/21/Dex2-wp/" class="post-title-link" itemprop="url">Dex2-wp</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2024-01-21 17:18:14 / 修改时间：17:18:39" itemprop="dateCreated datePublished" datetime="2024-01-21T17:18:14+08:00">2024-01-21</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Security/" itemprop="url" rel="index"><span itemprop="name">Security</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Ethernaut/" itemprop="url" rel="index"><span itemprop="name">Ethernaut</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/writeup/" itemprop="url" rel="index"><span itemprop="name">writeup</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>1.1k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>4 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="DEX2—wp"><a href="#DEX2—wp" class="headerlink" title="DEX2—wp"></a>DEX2—wp</h1><p>这道题中的 DEX 和上一个中有一处不同：<strong>该 DEX 的<code>swap</code>函数中没有检测 Token<code>from</code>&amp;<code>to</code>是否为该 DEX 中的 token1 和 token2</strong>。针对这一点可以对齐利用</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2024/01/21/Dex2-wp/" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/01/20/DEX-wp/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Q1ngying">
      <meta itemprop="description" content="今朝梦醒与君别，遥盼春风寄相思">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Q1ngying">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/01/20/DEX-wp/" class="post-title-link" itemprop="url">DEX-wp</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2024-01-20 18:01:25 / 修改时间：18:05:24" itemprop="dateCreated datePublished" datetime="2024-01-20T18:01:25+08:00">2024-01-20</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Security/" itemprop="url" rel="index"><span itemprop="name">Security</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Ethernaut/" itemprop="url" rel="index"><span itemprop="name">Ethernaut</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/writeup/" itemprop="url" rel="index"><span itemprop="name">writeup</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>1.7k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>6 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="DEX-wp"><a href="#DEX-wp" class="headerlink" title="DEX-wp"></a>DEX-wp</h1><p>这是一个拥有两个 ERC20 Token 的交易池，开始时，我们的账户中会拥有两种代币各10个。需要我们达到的目的是：将这个交易池中的代币至少一个清空，而这道题实际上就是一个典型的<strong>价格预言机操控攻击</strong>。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2024/01/20/DEX-wp/" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/01/20/Shop-wp/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Q1ngying">
      <meta itemprop="description" content="今朝梦醒与君别，遥盼春风寄相思">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Q1ngying">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/01/20/Shop-wp/" class="post-title-link" itemprop="url">Shop-wp</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2024-01-20 18:01:16 / 修改时间：18:05:05" itemprop="dateCreated datePublished" datetime="2024-01-20T18:01:16+08:00">2024-01-20</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Security/" itemprop="url" rel="index"><span itemprop="name">Security</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Ethernaut/" itemprop="url" rel="index"><span itemprop="name">Ethernaut</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/writeup/" itemprop="url" rel="index"><span itemprop="name">writeup</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>420</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Shop-wp"><a href="#Shop-wp" class="headerlink" title="Shop-wp"></a>Shop-wp</h1><p>合约可以以任何他们想要的方式操纵可看到的其他合约的数据。</p>
<p><strong>根据外部和不受信任的合约逻辑更改状态是不安全的</strong>。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2024/01/20/Shop-wp/" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/01/20/Denial-wp/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Q1ngying">
      <meta itemprop="description" content="今朝梦醒与君别，遥盼春风寄相思">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Q1ngying">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/01/20/Denial-wp/" class="post-title-link" itemprop="url">Denial-wp</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2024-01-20 18:01:04 / 修改时间：18:04:04" itemprop="dateCreated datePublished" datetime="2024-01-20T18:01:04+08:00">2024-01-20</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Security/" itemprop="url" rel="index"><span itemprop="name">Security</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Ethernaut/" itemprop="url" rel="index"><span itemprop="name">Ethernaut</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/writeup/" itemprop="url" rel="index"><span itemprop="name">writeup</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>406</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>1 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Denial-wp"><a href="#Denial-wp" class="headerlink" title="Denial-wp"></a>Denial-wp</h1><p>这道题还是一道 DoS 攻击的利用，只不过这里采用的是耗尽 gas 的方法以实现 DoS 攻击。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2024/01/20/Denial-wp/" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/01/19/Solidity%E7%BB%A7%E6%89%BF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Q1ngying">
      <meta itemprop="description" content="今朝梦醒与君别，遥盼春风寄相思">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Q1ngying">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/01/19/Solidity%E7%BB%A7%E6%89%BF/" class="post-title-link" itemprop="url">Solidity继承</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-01-19 19:47:03" itemprop="dateCreated datePublished" datetime="2024-01-19T19:47:03+08:00">2024-01-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-01-20 15:48:41" itemprop="dateModified" datetime="2024-01-20T15:48:41+08:00">2024-01-20</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Solidity/" itemprop="url" rel="index"><span itemprop="name">Solidity</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>4.8k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>16 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="继承"><a href="#继承" class="headerlink" title="继承"></a>继承</h1><h2 id="继承-1"><a href="#继承-1" class="headerlink" title="继承"></a>继承</h2><p>首先，<strong>Solidity 支持多重继承，包括多态性</strong></p>
<p>多态性意味着<strong>函数调用</strong>总是<strong>执行</strong>继承层次结构中<strong>最新继承合约</strong>的合约中的<strong>同名函数</strong>（和参数类型），但是，<strong>必须使用<code>virtual</code>和<code>override</code>关键字在层次结构中的每个函数上明确启用</strong></p>
<p>可以通过<code>ContractName.functionName()</code>明确指定合约，可以在内部调用继承层次结构中更高的函数。或者直接调用继承层次中调用高一级的函数，可以使用<code>super.functionName()</code>。</p>
<p>一个合约继承自其他合约，在区块链上<strong>只会创建一个单一的合约。</strong>所有基础合约的代码被编译到创建的合约中。这意味着，对基础合约的所有内部函数的调用都只是使用内部函数调用。</p>
<p>Solidity 的继承系统和 Python 的继承系统非常类似。</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2024/01/19/Solidity%E7%BB%A7%E6%89%BF/" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/01/19/%E5%87%BD%E6%95%B0%E9%87%8D%E8%BD%BD/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Q1ngying">
      <meta itemprop="description" content="今朝梦醒与君别，遥盼春风寄相思">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Q1ngying">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/01/19/%E5%87%BD%E6%95%B0%E9%87%8D%E8%BD%BD/" class="post-title-link" itemprop="url">函数重载</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2024-01-19 16:36:20 / 修改时间：16:37:26" itemprop="dateCreated datePublished" datetime="2024-01-19T16:36:20+08:00">2024-01-19</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Solidity/" itemprop="url" rel="index"><span itemprop="name">Solidity</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>808</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>3 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="函数重载"><a href="#函数重载" class="headerlink" title="函数重载"></a>函数重载</h1><h2 id="函数重载-1"><a href="#函数重载-1" class="headerlink" title="函数重载"></a>函数重载</h2><p>简单理解，<strong>一个合约中可以有多个同名的函数，但是这些函数的参数类型需要保证不同</strong>。</p>
<blockquote>
<p><strong>个人理解：</strong></p>
<p>在 Solidity 的底层，调用函数其实并不是通过函数名来调用的，而是通过<strong>函数选择器</strong>，函数选择器是<strong>函数签名的哈希值的前4个字节</strong>。函数签名不同，得到的函数选择器就会不同。所以这不会引起冲突。(<strong>函数签名：</strong>函数名和函数的参数，不使用空格分隔，比如：<code>func(uint256,uint8)</code>)</p>
</blockquote>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2024/01/19/%E5%87%BD%E6%95%B0%E9%87%8D%E8%BD%BD/" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/01/11/%E9%80%9A%E7%94%A8%E5%8D%87%E7%BA%A7%E5%90%88%E7%BA%A6%EF%BC%88UUPS%EF%BC%89/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Q1ngying">
      <meta itemprop="description" content="今朝梦醒与君别，遥盼春风寄相思">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Q1ngying">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/01/11/%E9%80%9A%E7%94%A8%E5%8D%87%E7%BA%A7%E5%90%88%E7%BA%A6%EF%BC%88UUPS%EF%BC%89/" class="post-title-link" itemprop="url">通用升级合约（UUPS）</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-01-11 20:07:46" itemprop="dateCreated datePublished" datetime="2024-01-11T20:07:46+08:00">2024-01-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-01-19 16:38:25" itemprop="dateModified" datetime="2024-01-19T16:38:25+08:00">2024-01-19</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Solidity/" itemprop="url" rel="index"><span itemprop="name">Solidity</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Proxy/" itemprop="url" rel="index"><span itemprop="name">Proxy</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Upgrade/" itemprop="url" rel="index"><span itemprop="name">Upgrade</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>1.2k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>4 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="通用升级合约（UUPS）"><a href="#通用升级合约（UUPS）" class="headerlink" title="通用升级合约（UUPS）"></a>通用升级合约（UUPS）</h1><p>通用升级合约（UUPS）相比透明代理合约，UUPS 代理合约最终可以移出其升级能力，使代码真正不可变，而且 UUPS 在技术上部署成本稍低一些。</p>
<p>OpenZeppelin 的文档中详细介绍了这两种代理的区别： <a target="_blank" rel="noopener" href="https://docs.openzeppelin.com/contracts/5.x/api/proxy#transparent-vs-uups">https://docs.openzeppelin.com/contracts/5.x/api/proxy#transparent-vs-uups</a> </p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2024/01/11/%E9%80%9A%E7%94%A8%E5%8D%87%E7%BA%A7%E5%90%88%E7%BA%A6%EF%BC%88UUPS%EF%BC%89/" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/01/10/%E5%8F%AF%E5%8D%87%E7%BA%A7%E5%90%88%E7%BA%A6-md/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Q1ngying">
      <meta itemprop="description" content="今朝梦醒与君别，遥盼春风寄相思">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Q1ngying">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/01/10/%E5%8F%AF%E5%8D%87%E7%BA%A7%E5%90%88%E7%BA%A6-md/" class="post-title-link" itemprop="url">可升级合约</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-01-10 18:01:23" itemprop="dateCreated datePublished" datetime="2024-01-10T18:01:23+08:00">2024-01-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-01-19 16:38:09" itemprop="dateModified" datetime="2024-01-19T16:38:09+08:00">2024-01-19</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Solidity/" itemprop="url" rel="index"><span itemprop="name">Solidity</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Proxy/" itemprop="url" rel="index"><span itemprop="name">Proxy</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Upgrade/" itemprop="url" rel="index"><span itemprop="name">Upgrade</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>1.4k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>5 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="可升级合约"><a href="#可升级合约" class="headerlink" title="可升级合约"></a>可升级合约</h1><p>合约升级包括三种方式（目前）</p>
<h2 id="参数化升级"><a href="#参数化升级" class="headerlink" title="参数化升级"></a>参数化升级</h2><p>这是升级智能合约最简单的方法，实际上，他并没有升级智能合约，因为我们不能真正的改变合约的逻辑。<strong>升级只是参数化一切</strong></p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2024/01/10/%E5%8F%AF%E5%8D%87%E7%BA%A7%E5%90%88%E7%BA%A6-md/" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2024/01/09/Foundry%E6%A8%A1%E7%B3%8A%E6%B5%8B%E8%AF%95%E5%85%A5%E9%97%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="Q1ngying">
      <meta itemprop="description" content="今朝梦醒与君别，遥盼春风寄相思">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Q1ngying">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2024/01/09/Foundry%E6%A8%A1%E7%B3%8A%E6%B5%8B%E8%AF%95%E5%85%A5%E9%97%A8/" class="post-title-link" itemprop="url">Foundry模糊测试入门</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2024-01-09 16:51:40" itemprop="dateCreated datePublished" datetime="2024-01-09T16:51:40+08:00">2024-01-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2024-01-19 16:38:36" itemprop="dateModified" datetime="2024-01-19T16:38:36+08:00">2024-01-19</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Solidity/" itemprop="url" rel="index"><span itemprop="name">Solidity</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Foundry/" itemprop="url" rel="index"><span itemprop="name">Foundry</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Fuzz/" itemprop="url" rel="index"><span itemprop="name">Fuzz</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>1.7k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>6 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Foundry模糊测试入门"><a href="#Foundry模糊测试入门" class="headerlink" title="Foundry模糊测试入门"></a>Foundry模糊测试入门</h1><p>关于模糊测试，需要首先考虑在我们的代码中<strong>系统的不变量&#x2F;属性</strong> 是什么，这样我们就可以编写一些<strong>有状态和无状态的模糊测试</strong></p>
<p><strong>定义：</strong></p>
<p>Fuzz 测试（模糊测试），是将随机数据提供给系统，以尝试破坏系统</p>
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2024/01/09/Foundry%E6%A8%A1%E7%B3%8A%E6%B5%8B%E8%AF%95%E5%85%A5%E9%97%A8/" rel="contents">
                阅读全文 &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Q1ngying"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">Q1ngying</p>
  <div class="site-description" itemprop="description">今朝梦醒与君别，遥盼春风寄相思</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">52</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">19</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">20</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/q1ngying" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;q1ngying" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:q1ngying@163.com" title="E-Mail → mailto:q1ngying@163.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2023-09 – 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Q1ngying</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
      <span class="post-meta-item-text">站点总字数：</span>
    <span title="站点总字数">142k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span class="post-meta-item-text">站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">7:52</span>
</div>

<div class="powered-by">
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <i class="fa fa-user-md"></i>
    <span id="busuanzi_container_site_uv">
        本站访客数:<span id="busuanzi_value_site_uv"></span>人
    </span>
    <span class="post-meta-divider">|</span>
    <span id="busuanzi_container_site_pv">
        本站访问量<span id="busuanzi_value_site_pv"></span>人次
    </span>
</div>

        








      </div>
    </footer>
  </div>

  
  
  <script color='255,255,255' opacity='1' zIndex='-1' count='99' src="/lib/canvas-nest/canvas-nest.min.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
